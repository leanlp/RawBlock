import type { Edge } from "@/lib/graph/types";

export const graphEdges: Edge[] = [
  { from: "block-header", to: "block", type: "PART_OF" },
  { from: "coinbase-transaction", to: "block", type: "PART_OF" },
  { from: "transaction", to: "block", type: "PART_OF" },
  { from: "input", to: "transaction", type: "PART_OF" },
  { from: "output", to: "transaction", type: "PART_OF" },
  { from: "scriptpubkey", to: "output", type: "PART_OF" },
  { from: "scriptsig", to: "input", type: "PART_OF" },
  { from: "witness-data", to: "input", type: "PART_OF" },
  { from: "nonce", to: "block-header", type: "PART_OF" },
  { from: "merkle-root", to: "block-header", type: "PART_OF" },
  { from: "prev-block-hash", to: "block-header", type: "PART_OF" },
  { from: "timestamp", to: "block-header", type: "PART_OF" },
  { from: "nbits", to: "block-header", type: "PART_OF" },
  { from: "version-field", to: "block-header", type: "PART_OF" },

  { from: "signature", to: "script", type: "VALIDATED_BY" },
  { from: "script", to: "transaction", type: "VALIDATED_BY" },
  { from: "ecdsa-signature", to: "signature", type: "PART_OF" },
  { from: "schnorr-signature", to: "signature", type: "PART_OF" },

  { from: "utxo", to: "output", type: "PART_OF" },
  { from: "transaction", to: "utxo", type: "INTRODUCED_BY" },
  { from: "input", to: "utxo", type: "DEPENDS_ON" },

  { from: "proof-of-work", to: "block", type: "VALIDATED_BY" },
  { from: "difficulty-target", to: "proof-of-work", type: "DEPENDS_ON" },
  { from: "nbits", to: "difficulty-target", type: "PART_OF" },
  { from: "chainwork", to: "proof-of-work", type: "DEPENDS_ON" },
  { from: "chainwork", to: "reorg", type: "VALIDATED_BY" },

  { from: "consensus-rules", to: "block", type: "VALIDATED_BY" },
  { from: "consensus-rules", to: "transaction", type: "VALIDATED_BY" },
  { from: "consensus-rules", to: "proof-of-work", type: "VALIDATED_BY" },
  { from: "halving", to: "block-subsidy", type: "STRENGTHENS" },
  { from: "block-subsidy", to: "coinbase-transaction", type: "PART_OF" },
  { from: "locktime", to: "transaction", type: "VALIDATED_BY" },
  { from: "sequence", to: "input", type: "PART_OF" },
  { from: "sequence", to: "locktime", type: "STRENGTHENS" },
  { from: "dust-limit", to: "output", type: "VALIDATED_BY" },

  { from: "mempool", to: "transaction", type: "DEPENDS_ON" },
  { from: "mining", to: "mempool", type: "DEPENDS_ON" },
  { from: "mining", to: "block", type: "INTRODUCED_BY" },
  { from: "confirmation", to: "block", type: "DEPENDS_ON" },
  { from: "confirmation", to: "transaction", type: "DEPENDS_ON" },
  { from: "fee-rate", to: "mempool", type: "STRENGTHENS" },
  { from: "replace-by-fee", to: "mempool", type: "PART_OF" },
  { from: "child-pays-for-parent", to: "mempool", type: "PART_OF" },
  { from: "replace-by-fee", to: "double-spend", type: "STRENGTHENS" },
  { from: "child-pays-for-parent", to: "transaction", type: "STRENGTHENS" },

  { from: "reorg", to: "double-spend", type: "STRENGTHENS" },
  { from: "reorg", to: "confirmation", type: "WEAKENS" },
  { from: "proof-of-work", to: "double-spend", type: "WEAKENS" },
  { from: "finality", to: "double-spend", type: "WEAKENS" },
  { from: "attack-51-percent", to: "reorg", type: "STRENGTHENS" },
  { from: "attack-51-percent", to: "finality", type: "WEAKENS" },
  { from: "selfish-mining", to: "reorg", type: "STRENGTHENS" },
  { from: "fee-sniping", to: "reorg", type: "STRENGTHENS" },
  { from: "eclipse-attack", to: "double-spend", type: "STRENGTHENS" },
  { from: "orphan-block", to: "reorg", type: "PART_OF" },

  { from: "segwit", to: "witness-data", type: "INTRODUCED_BY" },
  { from: "segwit", to: "p2wpkh", type: "INTRODUCED_BY" },
  { from: "segwit", to: "p2wsh", type: "INTRODUCED_BY" },
  { from: "segwit", to: "scriptsig", type: "WEAKENS" },
  { from: "taproot", to: "p2tr", type: "INTRODUCED_BY" },
  { from: "taproot", to: "schnorr-signature", type: "INTRODUCED_BY" },
  { from: "taproot", to: "script", type: "STRENGTHENS" },

  { from: "p2pkh", to: "scriptpubkey", type: "PART_OF" },
  { from: "p2sh", to: "scriptpubkey", type: "PART_OF" },
  { from: "p2wpkh", to: "scriptpubkey", type: "PART_OF" },
  { from: "p2wsh", to: "scriptpubkey", type: "PART_OF" },
  { from: "p2tr", to: "scriptpubkey", type: "PART_OF" },

  { from: "address-reuse", to: "utxo", type: "DEPENDS_ON" },
  { from: "address-reuse", to: "finality", type: "WEAKENS" },
  { from: "utxo-set-growth", to: "utxo", type: "DEPENDS_ON" },
  { from: "utxo-set-growth", to: "consensus-rules", type: "WEAKENS" },
];
