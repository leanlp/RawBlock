import type { GraphNode } from "@/lib/graph/types";

export const graphNodes: GraphNode[] = [
  {
    id: "block",
    type: "primitive",
    title: "Block",
    summary: "Container of validated transactions appended to the blockchain.",
    difficulty: 1,
    explorerLinks: ["block"],
  },
  {
    id: "block-header",
    type: "primitive",
    title: "Block Header",
    summary: "Metadata section hashed by miners to secure and identify a block.",
    difficulty: 1,
  },
  {
    id: "transaction",
    type: "primitive",
    title: "Transaction",
    summary: "State transition that consumes inputs and creates new outputs.",
    difficulty: 1,
    explorerLinks: ["transaction"],
  },
  {
    id: "input",
    type: "primitive",
    title: "Input",
    summary: "Reference to a previous output plus unlocking data proving spend rights.",
    difficulty: 1,
  },
  {
    id: "output",
    type: "primitive",
    title: "Output",
    summary: "Amount and locking conditions that define new spendable coins.",
    difficulty: 1,
  },
  {
    id: "utxo",
    type: "primitive",
    title: "Unspent Transaction Output (UTXO)",
    summary: "Represents spendable bitcoin. Forms the global state of Bitcoin.",
    difficulty: 1,
    explorerLinks: ["transaction", "address"],
    securityNotes: [
      "UTXO growth impacts node memory requirements",
      "Double-spend prevention relies on UTXO uniqueness",
    ],
  },
  {
    id: "script",
    type: "mechanism",
    title: "Script",
    summary: "Forth-like stack language used to lock and unlock outputs.",
    difficulty: 2,
  },
  {
    id: "signature",
    type: "mechanism",
    title: "Signature",
    summary: "Cryptographic proof authorizing spending conditions in scripts.",
    difficulty: 2,
  },
  {
    id: "proof-of-work",
    type: "mechanism",
    title: "Proof of Work",
    summary: "Consensus mechanism requiring costly hash computation for block production.",
    difficulty: 2,
    securityNotes: [
      "Security assumes majority honest hash power across time",
      "Cheap hash rental can temporarily increase reorg risk on thinly secured chains",
    ],
    securityCaseStudies: [
      {
        title: "Timewarp Attack Discussion",
        description:
          "Researchers have discussed timestamp manipulation strategies that could skew difficulty adjustment under specific miner coordination assumptions.",
        historicalReference: "Bitcoin Core issue and mailing-list discussions on timewarp vectors",
      },
    ],
  },
  {
    id: "difficulty-target",
    type: "rule",
    title: "Difficulty Target",
    summary: "Threshold a block hash must be below to be considered valid.",
    difficulty: 2,
  },
  {
    id: "coinbase-transaction",
    type: "primitive",
    title: "Coinbase Transaction",
    summary: "First transaction in a block creating subsidy and collecting fees.",
    difficulty: 2,
  },
  {
    id: "mempool",
    type: "mechanism",
    title: "Mempool",
    summary: "Node-local cache of valid but unconfirmed transactions.",
    difficulty: 1,
  },
  {
    id: "mining",
    type: "mechanism",
    title: "Mining",
    summary: "Process of assembling candidate blocks and searching for valid proof of work.",
    difficulty: 1,
  },
  {
    id: "reorg",
    type: "mechanism",
    title: "Reorg",
    summary: "Chain tip replacement when a competing branch with more work is accepted.",
    difficulty: 3,
    securityNotes: [
      "Short reorgs are normal; deep reorgs are operational red flags",
    ],
  },
  {
    id: "confirmation",
    type: "property",
    title: "Confirmation",
    summary: "A transaction being buried under one or more accepted blocks.",
    difficulty: 1,
  },
  {
    id: "segwit",
    type: "upgrade",
    title: "SegWit",
    summary: "Upgrade separating witness data and fixing transaction malleability vectors.",
    difficulty: 2,
  },
  {
    id: "taproot",
    type: "upgrade",
    title: "Taproot",
    summary: "Upgrade enabling Schnorr signatures and more private script paths.",
    difficulty: 3,
  },
  {
    id: "double-spend",
    type: "attack",
    title: "Double Spend",
    summary: "Attempt to spend the same coins twice via conflicting transactions.",
    difficulty: 2,
    securityNotes: [
      "Confirmation depth materially lowers practical success probability",
    ],
  },
  {
    id: "attack-51-percent",
    type: "attack",
    title: "51% Attack",
    summary: "Majority hash power attack enabling censorship and deep history rewrites.",
    difficulty: 4,
    securityNotes: [
      "Cannot forge coins or break signatures, but can reorder recent history",
    ],
  },
  {
    id: "nonce",
    type: "primitive",
    title: "Nonce",
    summary: "Header field miners vary while searching for a valid proof-of-work hash.",
    difficulty: 1,
  },
  {
    id: "merkle-root",
    type: "primitive",
    title: "Merkle Root",
    summary: "Commitment in the header summarizing all transactions in a block.",
    difficulty: 2,
  },
  {
    id: "prev-block-hash",
    type: "primitive",
    title: "Previous Block Hash",
    summary: "Header pointer linking each block to its parent.",
    difficulty: 1,
  },
  {
    id: "timestamp",
    type: "primitive",
    title: "Timestamp",
    summary: "Header time value used in consensus validity and difficulty adjustment.",
    difficulty: 1,
  },
  {
    id: "nbits",
    type: "primitive",
    title: "nBits",
    summary: "Compact encoding of the current difficulty target in the header.",
    difficulty: 2,
  },
  {
    id: "version-field",
    type: "primitive",
    title: "Version Field",
    summary: "Header signaling field used for soft-fork deployments.",
    difficulty: 2,
  },
  {
    id: "locktime",
    type: "rule",
    title: "Locktime",
    summary: "Constraint delaying transaction validity until a given block height or time.",
    difficulty: 2,
  },
  {
    id: "sequence",
    type: "rule",
    title: "Sequence",
    summary: "Per-input field used for relative timelocks and replaceability signaling.",
    difficulty: 3,
  },
  {
    id: "witness-data",
    type: "primitive",
    title: "Witness Data",
    summary: "Signature and script witness material committed separately under SegWit.",
    difficulty: 2,
  },
  {
    id: "scriptpubkey",
    type: "primitive",
    title: "scriptPubKey",
    summary: "Locking script in outputs defining spend conditions.",
    difficulty: 2,
  },
  {
    id: "scriptsig",
    type: "primitive",
    title: "scriptSig",
    summary: "Legacy unlocking script data provided in transaction inputs.",
    difficulty: 2,
  },
  {
    id: "schnorr-signature",
    type: "mechanism",
    title: "Schnorr Signature",
    summary: "Signature scheme introduced with Taproot enabling key aggregation.",
    difficulty: 3,
  },
  {
    id: "ecdsa-signature",
    type: "mechanism",
    title: "ECDSA Signature",
    summary: "Legacy Bitcoin signature scheme used before Taproot paths.",
    difficulty: 2,
  },
  {
    id: "p2pkh",
    type: "primitive",
    title: "P2PKH",
    summary: "Pay-to-PubKey-Hash legacy output template.",
    difficulty: 2,
    explorerLinks: ["address"],
  },
  {
    id: "p2sh",
    type: "primitive",
    title: "P2SH",
    summary: "Pay-to-Script-Hash template deferring script reveal until spend.",
    difficulty: 2,
  },
  {
    id: "p2wpkh",
    type: "primitive",
    title: "P2WPKH",
    summary: "Native SegWit output type for key-hash spends with lower weight.",
    difficulty: 2,
  },
  {
    id: "p2wsh",
    type: "primitive",
    title: "P2WSH",
    summary: "Native SegWit output type for script-hash spending conditions.",
    difficulty: 3,
  },
  {
    id: "p2tr",
    type: "primitive",
    title: "P2TR",
    summary: "Taproot output type supporting key-path and script-path spends.",
    difficulty: 3,
  },
  {
    id: "fee-rate",
    type: "property",
    title: "Fee Rate",
    summary: "Sats per virtual byte determining mempool and miner transaction priority.",
    difficulty: 1,
  },
  {
    id: "dust-limit",
    type: "rule",
    title: "Dust Limit",
    summary: "Policy threshold below which outputs are considered uneconomical spam.",
    difficulty: 2,
  },
  {
    id: "block-subsidy",
    type: "rule",
    title: "Block Subsidy",
    summary: "Protocol-defined new issuance paid to the block producer.",
    difficulty: 1,
    securityCaseStudies: [
      {
        title: "Value Overflow Bug (2010)",
        description:
          "An integer overflow bug allowed a transaction to create billions of BTC, violating supply invariants before emergency patching and chain rollback.",
        historicalReference: "CVE-2010-5139",
      },
    ],
  },
  {
    id: "halving",
    type: "rule",
    title: "Halving",
    summary: "Periodic reduction of block subsidy every 210,000 blocks.",
    difficulty: 1,
  },
  {
    id: "consensus-rules",
    type: "rule",
    title: "Consensus Rules",
    summary: "Network-wide validity rules all fully validating nodes must enforce.",
    difficulty: 2,
    securityNotes: [
      "Consensus divergence creates chain splits and incompatible histories",
    ],
    securityCaseStudies: [
      {
        title: "Inflation Bug in Bitcoin Core (2018)",
        description:
          "A consensus bug could allow duplicate inputs in a transaction under specific conditions, potentially enabling inflation if exploited.",
        historicalReference: "CVE-2018-17144",
      },
      {
        title: "Value Overflow Incident (2010)",
        description:
          "A critical arithmetic bug bypassed monetary constraints, demonstrating why strict consensus validation and rapid patch coordination are essential.",
        historicalReference: "August 15, 2010 overflow incident",
      },
    ],
  },
  {
    id: "chainwork",
    type: "property",
    title: "Chainwork",
    summary: "Cumulative proof-of-work metric used to select the best chain.",
    difficulty: 3,
  },
  {
    id: "finality",
    type: "property",
    title: "Probabilistic Finality",
    summary: "Confidence that a transaction will not be reversed grows with confirmations.",
    difficulty: 2,
  },
  {
    id: "orphan-block",
    type: "property",
    title: "Orphan/Stale Block",
    summary: "Valid block not on the eventual best chain due to propagation races.",
    difficulty: 2,
  },
  {
    id: "selfish-mining",
    type: "attack",
    title: "Selfish Mining",
    summary: "Strategy of withholding blocks to gain disproportionate mining rewards.",
    difficulty: 4,
    securityCaseStudies: [
      {
        title: "Selfish-Mining Strategy Publication",
        description:
          "A foundational paper formalized how strategic block withholding can outperform honest mining above certain hash-rate thresholds.",
        historicalReference:
          "Eyal and Sirer, 'Majority is not Enough: Bitcoin Mining is Vulnerable' (2014)",
      },
    ],
  },
  {
    id: "eclipse-attack",
    type: "attack",
    title: "Eclipse Attack",
    summary: "Isolates a node's network view to feed delayed or manipulated information.",
    difficulty: 4,
  },
  {
    id: "fee-sniping",
    type: "attack",
    title: "Fee Sniping",
    summary: "Miner strategy attempting reorgs to capture unusually high recent fees.",
    difficulty: 3,
  },
  {
    id: "replace-by-fee",
    type: "rule",
    title: "Replace-by-Fee (RBF)",
    summary: "Policy allowing unconfirmed transactions to be replaced by higher-fee versions.",
    difficulty: 2,
    securityNotes: [
      "Zero-confirmation acceptance is riskier for opt-in/full-RBF transactions",
    ],
  },
  {
    id: "child-pays-for-parent",
    type: "mechanism",
    title: "Child Pays For Parent (CPFP)",
    summary: "Fee-bumping method where a child transaction incentivizes parent confirmation.",
    difficulty: 2,
  },
  {
    id: "address-reuse",
    type: "property",
    title: "Address Reuse",
    summary: "Repeated use of the same receive address that weakens transaction privacy.",
    difficulty: 1,
    explorerLinks: ["address"],
    securityNotes: [
      "Reuse links payments and can reveal wallet ownership clusters",
    ],
  },
  {
    id: "utxo-set-growth",
    type: "property",
    title: "UTXO Set Growth",
    summary: "Long-term increase in live UTXOs that raises validation state costs.",
    difficulty: 2,
    securityNotes: [
      "Unbounded growth can increase node hardware requirements",
    ],
  },
];
