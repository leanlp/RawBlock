import type { GraphNode } from "@/lib/graph/types";
import { NODE_CLAIM_IDS } from "@/data/content/claims";
import {
  BITCOIN_BASE_LAYER_TPS_ESTIMATE,
  BITCOIN_HALVING_INTERVAL_BLOCKS,
  BITCOIN_MAX_SUPPLY_BTC,
} from "@/lib/constants/bitcoinProtocol";

export const graphNodes: GraphNode[] = [
  {
    id: "block",
    type: "primitive",
    title: "Block",
    summary: "Container of validated transactions appended to the blockchain.",
    difficulty: 1,
    explorerLinks: ["block"],
  },
  {
    id: "block-header",
    type: "primitive",
    title: "Block Header",
    summary: "Metadata section hashed by miners to secure and identify a block.",
    difficulty: 1,
  },
  {
    id: "transaction",
    type: "primitive",
    title: "Transaction",
    summary: "State transition that consumes inputs and creates new outputs.",
    difficulty: 1,
    explorerLinks: ["transaction"],
  },
  {
    id: "input",
    type: "primitive",
    title: "Input",
    summary: "Reference to a previous output plus unlocking data proving spend rights.",
    difficulty: 1,
  },
  {
    id: "output",
    type: "primitive",
    title: "Output",
    summary: "Amount and locking conditions that define new spendable coins.",
    difficulty: 1,
  },
  {
    id: "utxo",
    type: "primitive",
    title: "Unspent Transaction Output (UTXO)",
    summary: "Represents spendable bitcoin. Forms the global state of Bitcoin.",
    difficulty: 1,
    explorerLinks: ["transaction", "address"],
    securityNotes: [
      "UTXO growth impacts node memory requirements",
      "Double-spend prevention relies on UTXO uniqueness",
    ],
  },
  {
    id: "script",
    type: "mechanism",
    title: "Script",
    summary: "Forth-like stack language used to lock and unlock outputs.",
    difficulty: 2,
  },
  {
    id: "signature",
    type: "mechanism",
    title: "Signature",
    summary: "Cryptographic proof authorizing spending conditions in scripts.",
    difficulty: 2,
  },
  {
    id: "proof-of-work",
    type: "mechanism",
    title: "Proof of Work",
    summary: "Consensus mechanism requiring costly hash computation for block production.",
    difficulty: 2,
    securityNotes: [
      "Security assumes majority honest hash power across time",
      "Cheap hash rental can temporarily increase reorg risk on thinly secured chains",
    ],
    securityCaseStudies: [
      {
        title: "Timewarp Attack Discussion",
        description:
          "Researchers have discussed timestamp manipulation strategies that could skew difficulty adjustment under specific miner coordination assumptions.",
        historicalReference: "Bitcoin Core issue and mailing-list discussions on timewarp vectors",
      },
    ],
  },
  {
    id: "difficulty-target",
    type: "rule",
    title: "Difficulty Target",
    summary: "Threshold a block hash must be below to be considered valid.",
    difficulty: 2,
  },
  {
    id: "coinbase-transaction",
    type: "primitive",
    title: "Coinbase Transaction",
    summary: "First transaction in a block creating subsidy and collecting fees.",
    difficulty: 2,
  },
  {
    id: "mempool",
    type: "mechanism",
    title: "Mempool",
    summary: "Node-local cache of valid but unconfirmed transactions.",
    difficulty: 1,
  },
  {
    id: "mining",
    type: "mechanism",
    title: "Mining",
    summary: "Process of assembling candidate blocks and searching for valid proof of work.",
    difficulty: 1,
  },
  {
    id: "reorg",
    type: "mechanism",
    title: "Reorg",
    summary: "Chain tip replacement when a competing branch with more work is accepted.",
    difficulty: 3,
    securityNotes: [
      "Short reorgs are normal; deep reorgs are operational red flags",
    ],
  },
  {
    id: "confirmation",
    type: "property",
    title: "Confirmation",
    summary: "A transaction being buried under one or more accepted blocks.",
    difficulty: 1,
  },
  {
    id: "segwit",
    type: "upgrade",
    title: "SegWit",
    summary: "Upgrade separating witness data and fixing transaction malleability vectors.",
    difficulty: 2,
  },
  {
    id: "taproot",
    type: "upgrade",
    title: "Taproot",
    summary: "Upgrade enabling Schnorr signatures and more private script paths.",
    difficulty: 3,
  },
  {
    id: "what-is-bitcoin",
    type: "property",
    title: "What is Bitcoin",
    summary: `Decentralized peer-to-peer monetary network with a fixed supply of ${BITCOIN_MAX_SUPPLY_BTC.toLocaleString()} BTC enforced by consensus rules.`,
    difficulty: 1,
    claimIds: NODE_CLAIM_IDS["what-is-bitcoin"],
    furtherReading: [
      {
        title: "Bitcoin Whitepaper (Satoshi Nakamoto, 2008)",
        url: "https://bitcoin.org/bitcoin.pdf",
      },
      {
        title: "Bitcoin Developer Guide: Introduction",
        url: "https://developer.bitcoin.org/devguide/index.html",
      },
    ],
  },
  {
    id: "transactions-lifecycle",
    type: "mechanism",
    title: "Transactions Lifecycle",
    summary: "Lifecycle from wallet construction and signing, to mempool relay, mining inclusion, and confirmation depth growth.",
    difficulty: 1,
    claimIds: NODE_CLAIM_IDS["transactions-lifecycle"],
    advancedNotes: [
      "A transaction is first validated locally by a wallet/node before relay; invalid scripts and malformed serialization are rejected before reaching the mempool.",
      "Propagation is gossip-based across peers, so arrival order differs by node and network latency; miners do not share one global mempool.",
    ],
    furtherReading: [
      {
        title: "Bitcoin Developer Guide: Transactions",
        url: "https://developer.bitcoin.org/devguide/transactions.html",
      },
      {
        title: "BIP 125: Opt-in Full Replace-by-Fee Signaling",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki",
      },
    ],
  },
  {
    id: "utxo-model",
    type: "mechanism",
    title: "UTXO Model",
    summary: "State model where transactions consume prior outputs and create new outputs instead of updating account balances.",
    difficulty: 1,
    claimIds: NODE_CLAIM_IDS["utxo-model"],
    advancedNotes: [
      "UTXO selection strategy affects fees, privacy, and future spendability. Consolidation lowers future input count but can leak ownership clustering.",
      "Unlike account systems, Bitcoin validity depends on proving each spent output exists and is unspent at validation time.",
    ],
    furtherReading: [
      {
        title: "Bitcoin Developer Guide: Transactions and UTXOs",
        url: "https://developer.bitcoin.org/devguide/transactions.html",
      },
      {
        title: "BIP 30: Duplicate Transactions and UTXO Safety",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0030.mediawiki",
      },
    ],
  },
  {
    id: "blocks-and-headers",
    type: "primitive",
    title: "Blocks and Headers",
    summary: "Block headers commit to previous block hash, merkle root, and difficulty metadata, making history tamper-evident.",
    difficulty: 1,
    claimIds: NODE_CLAIM_IDS["blocks-and-headers"],
    furtherReading: [
      {
        title: "Bitcoin Developer Reference: Block Chain and Header Fields",
        url: "https://developer.bitcoin.org/reference/block_chain.html#block-headers",
      },
      {
        title: "BIP 34: Block Height in Coinbase for Version 2 Blocks",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki",
      },
    ],
  },
  {
    id: "mining-and-subsidy",
    type: "mechanism",
    title: "Mining and Subsidy",
    summary: `Miners perform proof-of-work and receive subsidy plus fees, with subsidy halving every ${BITCOIN_HALVING_INTERVAL_BLOCKS.toLocaleString()} blocks.`,
    difficulty: 2,
    claimIds: NODE_CLAIM_IDS["mining-and-subsidy"],
    advancedNotes: [
      "Miner revenue is subsidy + fees. Over long horizons, fee market dynamics increasingly matter as subsidy decays toward zero.",
      "Template construction (transaction selection and ordering) is a key competitive edge for miners during high-fee periods.",
    ],
    furtherReading: [
      {
        title: "Bitcoin Developer Reference: Block Subsidy",
        url: "https://developer.bitcoin.org/reference/block_chain.html#block-subsidy",
      },
      {
        title: "BIP 42: Finite Monetary Supply and Subsidy Overflow Fix",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0042.mediawiki",
      },
    ],
  },
  {
    id: "difficulty-adjustment-2016",
    type: "rule",
    title: "Difficulty Adjustment (2016)",
    summary: "Difficulty retargets every 2016 blocks to keep block production near a 10-minute average despite hashrate shocks.",
    difficulty: 2,
    claimIds: NODE_CLAIM_IDS["difficulty-adjustment-2016"],
    advancedNotes: [
      "Retarget uses elapsed time for the previous 2016-block epoch and clamps extreme shifts to preserve stability.",
      "Fast hashrate drops can cause temporarily slow blocks until the next retarget window completes.",
    ],
    furtherReading: [
      {
        title: "Bitcoin Wiki: Difficulty",
        url: "https://en.bitcoin.it/wiki/Difficulty",
      },
      {
        title: "Bitcoin Developer Reference: nBits and Target Encoding",
        url: "https://developer.bitcoin.org/reference/block_chain.html#target-nbits",
      },
    ],
  },
  {
    id: "consensus-rules-vs-policy",
    type: "rule",
    title: "Consensus Rules vs Policy",
    summary: "Consensus invalidates blocks/transactions network-wide; policy governs local relay and mempool behavior.",
    difficulty: 2,
    claimIds: NODE_CLAIM_IDS["consensus-rules-vs-policy"],
    advancedNotes: [
      "Consensus violations can split chains; policy differences only affect relay/mining preference and do not create permanent consensus forks by themselves.",
      "Standardness rules can evolve faster than consensus rules, allowing operational hardening without hard-forking consensus.",
    ],
    furtherReading: [
      {
        title: "Bitcoin Core Source: consensus.h (Consensus Constants)",
        url: "https://github.com/bitcoin/bitcoin/blob/master/src/consensus/consensus.h",
      },
      {
        title: "Bitcoin Core Source: policy.h (Relay/Mempool Policy)",
        url: "https://github.com/bitcoin/bitcoin/blob/master/src/policy/policy.h",
      },
    ],
  },
  {
    id: "pseudonymity-not-anonymity",
    type: "property",
    title: "Pseudonymity, Not Anonymity",
    summary: "Bitcoin addresses are not real names, but public transaction graphs enable tracing, clustering, and attribution.",
    difficulty: 1,
    claimIds: NODE_CLAIM_IDS["pseudonymity-not-anonymity"],
    furtherReading: [
      {
        title: "Bitcoin Wiki: Privacy",
        url: "https://en.bitcoin.it/wiki/Privacy",
      },
      {
        title: "Address Clustering in Bitcoin (Meiklejohn et al.)",
        url: "https://www.usenix.org/system/files/conference/imc13/imc13-meiklejohn.pdf",
      },
    ],
  },
  {
    id: "wallets-hold-keys-not-coins",
    type: "mechanism",
    title: "Wallets Hold Keys, Not Coins",
    summary: "Wallets store private keys and signing material that control UTXOs recorded on-chain; coins are never stored inside the wallet app.",
    difficulty: 1,
    claimIds: NODE_CLAIM_IDS["wallets-hold-keys-not-coins"],
    furtherReading: [
      {
        title: "Bitcoin Developer Guide: Wallets",
        url: "https://developer.bitcoin.org/devguide/wallets.html",
      },
      {
        title: "BIP 32: Hierarchical Deterministic Wallets",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki",
      },
    ],
  },
  {
    id: "address-vs-public-key",
    type: "primitive",
    title: "Address vs Public Key",
    summary: "Addresses are encoded script destinations; they are not identical to raw public keys, especially for SegWit and Taproot outputs.",
    difficulty: 2,
    claimIds: NODE_CLAIM_IDS["address-vs-public-key"],
    furtherReading: [
      {
        title: "BIP 173: Bech32 Address Format",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki",
      },
      {
        title: "BIP 350: Bech32m for Taproot Addresses",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki",
      },
    ],
  },
  {
    id: "lightning-network-maturity",
    type: "mechanism",
    title: "Lightning Network Maturity",
    summary: `Production-ready Layer 2 for fast, low-fee payments. Best for small/medium flow while base layer (~${BITCOIN_BASE_LAYER_TPS_ESTIMATE} TPS) remains final settlement.`,
    difficulty: 2,
    claimIds: NODE_CLAIM_IDS["lightning-network-maturity"],
    advancedNotes: [
      "Operational reliability depends on channel liquidity management, route quality, and fallback handling for failed pathfinding.",
      "Watchtowers and mobile-friendly channel management reduce risk for users that are not always online.",
    ],
    furtherReading: [
      {
        title: "Lightning Network BOLTs Specification",
        url: "https://github.com/lightning/bolts",
      },
      {
        title: "BIP 174: Partially Signed Bitcoin Transactions (for channel tooling and coordination)",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki",
      },
    ],
  },
  {
    id: "segwit-and-taproot-upgrades",
    type: "upgrade",
    title: "SegWit and Taproot Upgrades",
    summary: "Major soft-fork upgrades improving malleability resistance, efficiency, and script/signature capabilities without changing Bitcoin's monetary policy.",
    difficulty: 2,
    claimIds: NODE_CLAIM_IDS["segwit-and-taproot-upgrades"],
    furtherReading: [
      {
        title: "BIP 141: Segregated Witness (Consensus Layer)",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki",
      },
      {
        title: "BIP 340/341/342: Schnorr, Taproot, and Tapscript",
        url: "https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki",
      },
      {
        title: "bitcoin-dev Mailing List: Taproot Proposal Thread",
        url: "https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015614.html",
      },
    ],
  },
  {
    id: "double-spend",
    type: "attack",
    title: "Double Spend",
    summary: "Attempt to spend the same coins twice via conflicting transactions.",
    difficulty: 2,
    securityNotes: [
      "Confirmation depth materially lowers practical success probability",
    ],
  },
  {
    id: "attack-51-percent",
    type: "attack",
    title: "51% Attack",
    summary: "Majority hash power attack enabling censorship and deep history rewrites.",
    difficulty: 4,
    securityNotes: [
      "Cannot forge coins or break signatures, but can reorder recent history",
    ],
  },
  {
    id: "nonce",
    type: "primitive",
    title: "Nonce",
    summary: "Header field miners vary while searching for a valid proof-of-work hash.",
    difficulty: 1,
  },
  {
    id: "merkle-root",
    type: "primitive",
    title: "Merkle Root",
    summary: "Commitment in the header summarizing all transactions in a block.",
    difficulty: 2,
  },
  {
    id: "prev-block-hash",
    type: "primitive",
    title: "Previous Block Hash",
    summary: "Header pointer linking each block to its parent.",
    difficulty: 1,
  },
  {
    id: "timestamp",
    type: "primitive",
    title: "Timestamp",
    summary: "Header time value used in consensus validity and difficulty adjustment.",
    difficulty: 1,
  },
  {
    id: "nbits",
    type: "primitive",
    title: "nBits",
    summary: "Compact encoding of the current difficulty target in the header.",
    difficulty: 2,
  },
  {
    id: "version-field",
    type: "primitive",
    title: "Version Field",
    summary: "Header signaling field used for soft-fork deployments.",
    difficulty: 2,
  },
  {
    id: "locktime",
    type: "rule",
    title: "Locktime",
    summary: "Constraint delaying transaction validity until a given block height or time.",
    difficulty: 2,
  },
  {
    id: "sequence",
    type: "rule",
    title: "Sequence",
    summary: "Per-input field used for relative timelocks and replaceability signaling.",
    difficulty: 3,
  },
  {
    id: "witness-data",
    type: "primitive",
    title: "Witness Data",
    summary: "Signature and script witness material committed separately under SegWit.",
    difficulty: 2,
  },
  {
    id: "scriptpubkey",
    type: "primitive",
    title: "scriptPubKey",
    summary: "Locking script in outputs defining spend conditions.",
    difficulty: 2,
  },
  {
    id: "scriptsig",
    type: "primitive",
    title: "scriptSig",
    summary: "Legacy unlocking script data provided in transaction inputs.",
    difficulty: 2,
  },
  {
    id: "schnorr-signature",
    type: "mechanism",
    title: "Schnorr Signature",
    summary: "Signature scheme introduced with Taproot enabling key aggregation.",
    difficulty: 3,
  },
  {
    id: "ecdsa-signature",
    type: "mechanism",
    title: "ECDSA Signature",
    summary: "Legacy Bitcoin signature scheme used before Taproot paths.",
    difficulty: 2,
  },
  {
    id: "p2pkh",
    type: "primitive",
    title: "P2PKH",
    summary: "Pay-to-PubKey-Hash legacy output template.",
    difficulty: 2,
    explorerLinks: ["address"],
  },
  {
    id: "p2sh",
    type: "primitive",
    title: "P2SH",
    summary: "Pay-to-Script-Hash template deferring script reveal until spend.",
    difficulty: 2,
  },
  {
    id: "p2wpkh",
    type: "primitive",
    title: "P2WPKH",
    summary: "Native SegWit output type for key-hash spends with lower weight.",
    difficulty: 2,
  },
  {
    id: "p2wsh",
    type: "primitive",
    title: "P2WSH",
    summary: "Native SegWit output type for script-hash spending conditions.",
    difficulty: 3,
  },
  {
    id: "p2tr",
    type: "primitive",
    title: "P2TR",
    summary: "Taproot output type supporting key-path and script-path spends.",
    difficulty: 3,
  },
  {
    id: "fee-rate",
    type: "property",
    title: "Fee Rate",
    summary: "Sats per virtual byte determining mempool and miner transaction priority.",
    difficulty: 1,
  },
  {
    id: "dust-limit",
    type: "rule",
    title: "Dust Limit",
    summary: "Policy threshold below which outputs are considered uneconomical spam.",
    difficulty: 2,
  },
  {
    id: "block-subsidy",
    type: "rule",
    title: "Block Subsidy",
    summary: "Protocol-defined new issuance paid to the block producer.",
    difficulty: 1,
    securityCaseStudies: [
      {
        title: "Value Overflow Bug (2010)",
        description:
          "An integer overflow bug allowed a transaction to create billions of BTC, violating supply invariants before emergency patching and chain rollback.",
        historicalReference: "CVE-2010-5139",
      },
    ],
  },
  {
    id: "halving",
    type: "rule",
    title: "Halving",
    summary: `Periodic reduction of block subsidy every ${BITCOIN_HALVING_INTERVAL_BLOCKS.toLocaleString()} blocks.`,
    difficulty: 1,
  },
  {
    id: "consensus-rules",
    type: "rule",
    title: "Consensus Rules",
    summary: "Network-wide validity rules all fully validating nodes must enforce.",
    difficulty: 2,
    securityNotes: [
      "Consensus divergence creates chain splits and incompatible histories",
    ],
    securityCaseStudies: [
      {
        title: "Inflation Bug in Bitcoin Core (2018)",
        description:
          "A consensus bug could allow duplicate inputs in a transaction under specific conditions, potentially enabling inflation if exploited.",
        historicalReference: "CVE-2018-17144",
      },
      {
        title: "Value Overflow Incident (2010)",
        description:
          "A critical arithmetic bug bypassed monetary constraints, demonstrating why strict consensus validation and rapid patch coordination are essential.",
        historicalReference: "August 15, 2010 overflow incident",
      },
    ],
  },
  {
    id: "chainwork",
    type: "property",
    title: "Chainwork",
    summary: "Cumulative proof-of-work metric used to select the best chain.",
    difficulty: 3,
  },
  {
    id: "finality",
    type: "property",
    title: "Probabilistic Finality",
    summary: "Confidence that a transaction will not be reversed grows with confirmations.",
    difficulty: 2,
  },
  {
    id: "immutability",
    type: "property",
    title: "Immutability",
    summary: "Economic and computational cost of rewriting deep transaction history.",
    difficulty: 2,
  },
  {
    id: "orphan-block",
    type: "property",
    title: "Orphan/Stale Block",
    summary: "Valid block not on the eventual best chain due to propagation races.",
    difficulty: 2,
  },
  {
    id: "selfish-mining",
    type: "attack",
    title: "Selfish Mining",
    summary: "Strategy of withholding blocks to gain disproportionate miner revenue.",
    difficulty: 4,
    securityCaseStudies: [
      {
        title: "Selfish-Mining Strategy Publication",
        description:
          "A foundational paper formalized how strategic block withholding can outperform honest mining above certain hash-rate thresholds.",
        historicalReference:
          "Eyal and Sirer, 'Majority is not Enough: Bitcoin Mining is Vulnerable' (2014)",
      },
    ],
  },
  {
    id: "eclipse-attack",
    type: "attack",
    title: "Eclipse Attack",
    summary: "Isolates a node's network view to feed delayed or manipulated information.",
    difficulty: 4,
  },
  {
    id: "fee-sniping",
    type: "attack",
    title: "Fee Sniping",
    summary: "Miner strategy attempting reorgs to capture unusually high recent fees.",
    difficulty: 3,
  },
  {
    id: "replace-by-fee",
    type: "rule",
    title: "Replace-by-Fee (RBF)",
    summary: "Policy allowing unconfirmed transactions to be replaced by higher-fee versions.",
    difficulty: 2,
    securityNotes: [
      "Zero-confirmation acceptance is riskier for opt-in/full-RBF transactions",
    ],
  },
  {
    id: "child-pays-for-parent",
    type: "mechanism",
    title: "Child Pays For Parent (CPFP)",
    summary: "Fee-bumping method where a child transaction incentivizes parent confirmation.",
    difficulty: 2,
  },
  {
    id: "address-reuse",
    type: "property",
    title: "Address Reuse",
    summary: "Repeated use of the same receive address that weakens transaction privacy.",
    difficulty: 1,
    explorerLinks: ["address"],
    securityNotes: [
      "Reuse links payments and can reveal wallet ownership clusters",
    ],
  },
  {
    id: "utxo-set-growth",
    type: "property",
    title: "UTXO Set Growth",
    summary: "Long-term increase in live UTXOs that raises validation state costs.",
    difficulty: 2,
    securityNotes: [
      "Unbounded growth can increase node hardware requirements",
    ],
  },
  {
    id: "hashpower-majority-assumption",
    type: "assumption",
    title: "Hashpower Majority Assumption",
    summary: "Majority of aggregate hashpower follows protocol-valid chain selection.",
    difficulty: 3,
  },
  {
    id: "independent-validation-assumption",
    type: "assumption",
    title: "Independent Validation Assumption",
    summary: "Nodes independently validate blocks and transactions rather than trusting peers.",
    difficulty: 2,
  },
  {
    id: "network-topology-assumption",
    type: "assumption",
    title: "Network Topology Assumption",
    summary: "Propagation remains sufficiently well-connected to limit strategic withholding advantage.",
    difficulty: 3,
  },
  {
    id: "sha256-preimage-resistance-assumption",
    type: "assumption",
    title: "SHA256 Preimage Resistance Assumption",
    summary: "SHA256 remains preimage resistant for practical adversaries.",
    difficulty: 3,
  },
  {
    id: "decentralized-hash-distribution",
    type: "mechanism",
    title: "Decentralized Hash Distribution",
    summary: "Security posture where mining power concentration remains below majority control risk.",
    difficulty: 3,
  },
  {
    id: "faster-block-propagation",
    type: "mechanism",
    title: "Faster Block Propagation",
    summary: "Relay improvements that reduce stale races and selfish mining edge.",
    difficulty: 3,
  },
  {
    id: "value-overflow-2010",
    type: "vulnerability",
    title: "2010 Value Overflow Bug",
    summary: "Integer overflow flaw that enabled an inflation transaction creating invalid supply.",
    difficulty: 4,
  },
  {
    id: "cve-2018-17144",
    type: "vulnerability",
    title: "CVE-2018-17144",
    summary: "Duplicate-input validation bug with potential inflation and consensus failure impact.",
    difficulty: 4,
  },
  {
    id: "cve-2013-2292",
    type: "vulnerability",
    title: "CVE-2013-2292",
    summary: "Database compatibility fork incident causing temporary chain split conditions.",
    difficulty: 3,
  },
  {
    id: "timewarp-theoretical",
    type: "vulnerability",
    title: "Timewarp Vulnerability",
    summary: "Theoretical timestamp manipulation vector against historical difficulty adjustment behavior.",
    difficulty: 3,
  },
  {
    id: "malleability-pre-segwit",
    type: "vulnerability",
    title: "Pre-SegWit Transaction Malleability",
    summary: "Legacy transaction malleability issue affecting unconfirmed tx tracking and protocols.",
    difficulty: 3,
  },
];
