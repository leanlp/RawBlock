import type { Vulnerability } from "@/lib/graph/types";

export const vulnerabilities: Vulnerability[] = [
  {
    id: "value-overflow-2010",
    title: "2010 Value Overflow Bug",
    year: 2010,
    affectedVersions: ["Bitcoin 0.3.x"],
    rootCause: "Integer overflow during transaction output value validation.",
    impact: "184+ billion BTC were created in a single invalid inflation transaction.",
    fixedBy: "Emergency soft fork and patched validation rules.",
    relatedNodes: ["block-subsidy", "consensus-rules", "transaction"],
    exploitationType: "inflation",
    severity: "critical",
  },
  {
    id: "cve-2018-17144",
    title: "Duplicate Input Inflation Bug",
    cve: "CVE-2018-17144",
    year: 2018,
    affectedVersions: ["0.14.x", "0.15.x", "0.16.x"],
    rootCause: "Missing duplicate input check in specific validation paths.",
    impact: "Potential inflation and consensus failure risk if exploited on chain.",
    fixedBy: "Bitcoin Core 0.16.3 patch with restored duplicate-input enforcement.",
    relatedNodes: ["consensus-rules", "input", "transaction"],
    exploitationType: "inflation",
    severity: "critical",
  },
  {
    id: "cve-2013-2292",
    title: "BerkeleyDB Chain Fork Incident",
    cve: "CVE-2013-2292",
    year: 2013,
    affectedVersions: ["0.8.0", "0.8.1"],
    rootCause: "Database limit incompatibility between BerkeleyDB and LevelDB node sets.",
    impact: "Temporary chain split and consensus instability across client versions.",
    fixedBy: "Coordinated downgrade and compatibility response across miners and nodes.",
    relatedNodes: ["consensus-rules", "block", "reorg"],
    exploitationType: "consensus",
    severity: "high",
  },
  {
    id: "timewarp-theoretical",
    title: "Timewarp Vulnerability (Theoretical)",
    year: 2012,
    affectedVersions: ["All PoW-era consensus versions"],
    rootCause: "Timestamp manipulation can bias historical difficulty retarget behavior.",
    impact: "Difficulty manipulation risk under coordinated miner behavior.",
    fixedBy: "No full canonical mainnet fix; discussed mitigations and rule refinements.",
    relatedNodes: ["proof-of-work", "difficulty-target", "timestamp", "nbits"],
    exploitationType: "consensus",
    severity: "medium",
  },
  {
    id: "malleability-pre-segwit",
    title: "Transaction Malleability (Pre-SegWit)",
    year: 2014,
    affectedVersions: ["Pre-SegWit transaction relay and wallet flows"],
    rootCause: "Txid instability from mutable signature/script serialization fields.",
    impact: "Unconfirmed transaction tracking and protocol overlays could be disrupted.",
    fixedBy: "SegWit txid/wtxid separation and witness commitment model.",
    relatedNodes: ["transaction", "signature", "scriptsig", "segwit"],
    exploitationType: "policy",
    severity: "high",
  },
];
